<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>SCA vs PCA â€¢ spots</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SCA vs PCA">
<meta property="og:description" content="spots">
<meta property="og:image" content="https://stevexniu.github.io/spots/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
<script src="../darkswitch.js"></script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spots</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/get_started.html">Get started</a>
    </li>
    <li>
      <a href="../articles/SCA_vs_PCA.html">SCA vs PCA</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
          <a href="#" id="css-toggle-btn">
            <span class="fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        <li>
  <a href="https://github.com/stevexniu/spots/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
        
        


      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SCA vs PCA</h1>
            
            <h4 data-toc-skip class="date">Last Run: May 19, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stevexniu/spots/blob/HEAD/vignettes/SCA_vs_PCA.Rmd" class="external-link"><code>vignettes/SCA_vs_PCA.Rmd</code></a></small>
      <div class="hidden name"><code>SCA_vs_PCA.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="spatially-aware-dimensional-reduction">Spatially-aware dimensional reduction<a class="anchor" aria-label="anchor" href="#spatially-aware-dimensional-reduction"></a>
</h3>
<p>In this tutorial, we will examine the spatial influences on cluster (cell-type) discovery, and how we can incorporate the location information to achieve a spatially-aware dimensional reduction.</p>
<p>For this tutorial, we will simulate 1000 single-cell RNA-seq data using <a href="https://bioconductor.org/packages/release/bioc/html/splatter.html" class="external-link">splatter</a>. There are two transcriptionally distinct clusters namely <code>RNA.Group1</code> and <code>RNA.Group2</code>, and within each cluster, there are two spatially distinct types (<code>Spatial.Group1</code>,<code>Spatial.Group2</code> and <code>Spatial.Group3</code>,<code>Spatial.Group4</code>). As expected, canonical Principal Component Analysis (PCA) cannot reveal this spatial information.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install dependencies</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"scater"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"scater"</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"splatter"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"splatter"</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"Seurat"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"Seurat"</span><span class="op">)</span> <span class="op">&lt;</span> <span class="st">"4.0.0"</span><span class="op">)</span>
  <span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_version.html" class="external-link">install_version</a></span><span class="op">(</span><span class="st">"Seurat"</span>, version <span class="op">=</span> <span class="st">"4.0.0"</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"spots"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"spots"</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Oshlack/splatter" class="external-link">splatter</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/" class="external-link">scater</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">spots</span><span class="op">)</span>

<span class="va">sim.groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/splatter/man/splatSimulate.html" class="external-link">splatSimulate</a></span><span class="op">(</span>group.prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"groups"</span>,
                            verbose <span class="op">=</span> <span class="cn">FALSE</span>, batchCells <span class="op">=</span> <span class="fl">1100</span>, nGenes <span class="op">=</span> <span class="fl">5000</span>,seed<span class="op">=</span><span class="fl">123</span><span class="op">)</span>
<span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">sim.groups</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sim.groups</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">"Group1"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span>,
                                                     <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sim.groups</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">"Group2"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">sim.data</span><span class="op">$</span><span class="va">RNA.group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RNA.Group1"</span>,<span class="st">"RNA.Group2"</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span>
<span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/Idents.html" class="external-link">SetIdent</a></span><span class="op">(</span><span class="va">sim.data</span>, value <span class="op">=</span> <span class="st">"RNA.group"</span><span class="op">)</span>
<span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial.group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spatial.Group1"</span>, <span class="st">"Spatial.Group2"</span>, 
                                       <span class="st">"Spatial.Group3"</span>, <span class="st">"Spatial.Group4"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">250</span><span class="op">)</span><span class="op">)</span>
<span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">sim.data</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span><span class="va">sim.data</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="va">sim.data</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span><span class="va">sim.data</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">PCAPlot</a></span><span class="op">(</span><span class="va">sim.data</span>, group.by <span class="op">=</span> <span class="st">"RNA.group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">PCAPlot</a></span><span class="op">(</span><span class="va">sim.data</span>, group.by <span class="op">=</span> <span class="st">"Spatial.group"</span><span class="op">)</span></code></pre></div>
<p><img src="SCA_vs_PCA_files/figure-html/load-1.png" width="1920"></p>
</div>
<div class="section level3">
<h3 id="incorporating-the-spatial-coordinates">Incorporating the spatial coordinates<a class="anchor" aria-label="anchor" href="#incorporating-the-spatial-coordinates"></a>
</h3>
<p>Here, we simulated the X-Y coordinates for the four spatially distinct groups. We then use the X-Y coordinates as input and performed the Spatial Component Analysis (SCA) using the <code>SCA</code> function from <code>spots</code>.</p>
<p>We can see that while PCA ignores spatial information, SCA preserves the spatial structure within the data. And subsequent clustering analysis using Spatial Components is able to recapitulate all four spatially distinct groups.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">group1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fl">0.1</span>,<span class="fl">0.035</span><span class="op">)</span>
<span class="va">group2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fl">0.9</span>,<span class="fl">0.035</span><span class="op">)</span>
<span class="va">group3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fl">0.1</span>,<span class="fl">0.035</span><span class="op">)</span>
<span class="va">group4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fl">0.9</span>,<span class="fl">0.035</span><span class="op">)</span>
<span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group1</span>, <span class="va">group1</span>, <span class="va">group2</span>, <span class="va">group2</span><span class="op">)</span>
<span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group3</span>, <span class="va">group4</span>, <span class="va">group3</span>, <span class="va">group4</span><span class="op">)</span>
<span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">@</span><span class="va">meta.data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spatial_1"</span>,<span class="st">"Spatial_2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">W</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span> 
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">@</span><span class="va">assays</span><span class="op">$</span><span class="va">RNA</span><span class="op">@</span><span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://satijalab.org/seurat/reference/VariableFeatures.html" class="external-link">VariableFeatures</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCA.html">SCA</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">W</span>, n.eigen <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="va">sim.data</span><span class="op">@</span><span class="va">reductions</span><span class="op">[[</span><span class="st">"sca"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/CreateDimReducObject.html" class="external-link">CreateDimReducObject</a></span><span class="op">(</span>embeddings <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">X</span>,
                                                    loadings <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">rotation</span>, 
                                                    stdev <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">eigenvalues</span>,
                                                    assay <span class="op">=</span> <span class="st">"RNA"</span>,key<span class="op">=</span><span class="st">"SC_"</span><span class="op">)</span>
<span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span><span class="va">sim.data</span>, reduction <span class="op">=</span> <span class="st">"sca"</span>, 
                          k.param <span class="op">=</span> <span class="fl">100</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, 
                          graph.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sca_nn"</span>, <span class="st">"sca_snn"</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">sim.data</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">FindClusters</a></span><span class="op">(</span><span class="va">sim.data</span>, graph.name <span class="op">=</span> <span class="st">"sca_snn"</span>, resolution <span class="op">=</span> <span class="fl">1</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span><span class="va">sim.data</span>, reduction <span class="op">=</span> <span class="st">"pca"</span>, 
                          k.param <span class="op">=</span> <span class="fl">100</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,
                          graph.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pca_nn"</span>, <span class="st">"pca_snn"</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">sim.data</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">FindClusters</a></span><span class="op">(</span><span class="va">sim.data</span>, graph.name <span class="op">=</span> <span class="st">"pca_snn"</span>, resolution <span class="op">=</span> <span class="fl">1</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="op">(</span><span class="fu"><a href="https://satijalab.org/seurat/reference/FeatureScatter.html" class="external-link">FeatureScatter</a></span><span class="op">(</span><span class="va">sim.data</span>, <span class="st">"Spatial_1"</span>, <span class="st">"Spatial_2"</span>, group.by <span class="op">=</span> <span class="st">"Spatial.group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://satijalab.org/seurat/reference/FeatureScatter.html" class="external-link">FeatureScatter</a></span><span class="op">(</span><span class="va">sim.data</span>, <span class="st">"Spatial_1"</span>, <span class="st">"Spatial_2"</span>, group.by <span class="op">=</span> <span class="st">"RNA.group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span>
<span class="op">(</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">sim.data</span>, reduction <span class="op">=</span> <span class="st">"pca"</span>, group.by <span class="op">=</span> <span class="st">"Spatial.group"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">sim.data</span>, reduction <span class="op">=</span> <span class="st">"sca"</span>, group.by <span class="op">=</span> <span class="st">"Spatial.group"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span>
<span class="op">(</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">sim.data</span>, reduction <span class="op">=</span> <span class="st">"pca"</span>, group.by <span class="op">=</span> <span class="st">"pca_snn_res.1"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">sim.data</span>, reduction <span class="op">=</span> <span class="st">"sca"</span>, group.by <span class="op">=</span> <span class="st">"sca_snn_res.1"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="SCA_vs_PCA_files/figure-html/sca-1.png" width="1920"></p>
</div>
<div class="section level3">
<h3 id="simulation-experiment">Simulation Experiment<a class="anchor" aria-label="anchor" href="#simulation-experiment"></a>
</h3>
<p>We now simulate a set of different spatial coordinates on the X-Y plane, in total <code>17 X-axis * 17 Y-axis = 289</code> distinct locations for the four spatial clusters</p>
<p>As we can see, when the X-Y coordinates get too close, the four spatial clusters start to overlap and are not distinguishable.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"RColorBrewer"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"RColorBrewer"</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://wilkelab.org/cowplot/" class="external-link">"cowplot"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"cowplot"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>

<span class="va">ari.param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.05</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
<span class="va">ari.scatter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
  <span class="va">group1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">group2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">group3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">group4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group1</span>, <span class="va">group1</span>, <span class="va">group2</span>, <span class="va">group2</span><span class="op">)</span>
  <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group3</span>, <span class="va">group4</span>, <span class="va">group3</span>, <span class="va">group4</span><span class="op">)</span>
  <span class="va">ari.scatter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ari.scatter</span>,
                      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">@</span><span class="va">meta.data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Spatial_1'</span>,<span class="st">"Spatial_2"</span>,<span class="st">"RNA.group"</span>,<span class="st">"Spatial.group"</span><span class="op">)</span><span class="op">]</span>,
                            X <span class="op">=</span> <span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span>, Y <span class="op">=</span> <span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">ari.scatter</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ari.scatter</span><span class="op">$</span><span class="va">Y</span>,levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ari.scatter</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ari.scatter</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Spatial_1</span>,<span class="va">Spatial_2</span>,col<span class="op">=</span><span class="va">Spatial.group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">4</span>,<span class="st">"Set1"</span><span class="op">)</span>,<span class="fl">0.7</span><span class="op">)</span>, aesthetics <span class="op">=</span> <span class="st">"colour"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X</span>,scales <span class="op">=</span> <span class="st">"fix"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"X axis"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Y axis"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>,
        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">20</span><span class="op">)</span>,
        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,
        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">20</span>,vjust <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,
        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">20</span>,vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,
        legend.text <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">20</span><span class="op">)</span>,
        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0</span>,angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,
        axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">ncell</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
  <span class="va">group1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">group2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">group3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">group4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group1</span>, <span class="va">group1</span>, <span class="va">group2</span>, <span class="va">group2</span><span class="op">)</span>
  <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group3</span>, <span class="va">group4</span>, <span class="va">group3</span>, <span class="va">group4</span><span class="op">)</span>
  <span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">250</span><span class="op">]</span><span class="op">)</span>
  <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">250</span><span class="op">]</span><span class="op">)</span>
  <span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="fl">251</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> 
                       <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="fl">251</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> 
                       <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="fl">251</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> 
                       <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="fl">251</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="fl">251</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span><span class="op">)</span>
  <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="fl">251</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span><span class="op">)</span>
  <span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cells</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">251</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> 
                                <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">251</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> 
                                <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">251</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> 
                                <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">251</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">750</span><span class="op">]</span><span class="op">)</span>
  <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">750</span><span class="op">]</span><span class="op">)</span>
  <span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cells</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">501</span><span class="op">:</span><span class="fl">750</span><span class="op">)</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> 
                                <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">501</span><span class="op">:</span><span class="fl">750</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> 
                                <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">501</span><span class="op">:</span><span class="fl">750</span><span class="op">)</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> 
                                <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">501</span><span class="op">:</span><span class="fl">750</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="fl">751</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span><span class="op">)</span>
  <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="fl">751</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span><span class="op">)</span>
  <span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cells</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">750</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> 
                                <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">750</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">r1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> 
                                <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">750</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> 
                                <span class="op">&amp;</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">750</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">r2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span>
  <span class="va">ncell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ncell</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">ari.param</span><span class="op">$</span><span class="va">percent</span> <span class="op">&lt;-</span> <span class="va">ncell</span><span class="op">*</span><span class="fl">100</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ari.param</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Var1</span>,<span class="va">Var2</span>,fill <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>,<span class="st">"YlGn"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">percent</span><span class="op">&gt;</span><span class="fl">50</span>,<span class="op">]</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Var1</span>,<span class="va">Var2</span><span class="op">)</span>,
            label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">percent</span><span class="op">&gt;</span><span class="fl">50</span>,<span class="st">"percent"</span><span class="op">]</span>,<span class="fl">0</span><span class="op">)</span>,
            size<span class="op">=</span><span class="fl">6</span>,col<span class="op">=</span><span class="st">"white"</span>, inherit.aes <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">percent</span><span class="op">&lt;=</span><span class="fl">50</span>,<span class="op">]</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Var1</span>,<span class="va">Var2</span><span class="op">)</span>,
            label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">percent</span><span class="op">&lt;=</span><span class="fl">50</span>,<span class="st">"percent"</span><span class="op">]</span>,<span class="fl">0</span><span class="op">)</span>,
            size<span class="op">=</span><span class="fl">6</span>,col<span class="op">=</span><span class="st">"black"</span>, inherit.aes <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Overlapping of Spatial Clusters"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html" class="external-link">theme_cowplot</a></span><span class="op">(</span>font_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html" class="external-link">NoAxes</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">30</span>,hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, 
        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></code></pre></div>
<p><img src="SCA_vs_PCA_files/figure-html/spatial-1.png" width="2880"></p>
<p>We perform Spatial Component Analysis using the <code>SCA</code> function for all the 289 simulations. To evaluate the performance of SCA and the clustering results, we calculated the number of clusters and <a href="https://en.wikipedia.org/wiki/Rand_index" class="external-link">Adjusted Rand Index</a></p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://mclust-org.github.io/mclust/" class="external-link">"mclust"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"mclust"</span><span class="op">)</span>

<span class="va">ari</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">nclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">clustering</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
  <span class="va">group1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">group2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">group3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">group4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">250</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">0.035</span><span class="op">)</span>
  <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group1</span>, <span class="va">group1</span>, <span class="va">group2</span>, <span class="va">group2</span><span class="op">)</span>
  <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group3</span>, <span class="va">group4</span>, <span class="va">group3</span>, <span class="va">group4</span><span class="op">)</span>
  <span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">@</span><span class="va">meta.data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spatial_1"</span>,<span class="st">"Spatial_2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">W</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span> 
  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">@</span><span class="va">assays</span><span class="op">$</span><span class="va">RNA</span><span class="op">@</span><span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://satijalab.org/seurat/reference/VariableFeatures.html" class="external-link">VariableFeatures</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCA.html">SCA</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">W</span>, n.eigen <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
  <span class="va">sim.data</span><span class="op">@</span><span class="va">reductions</span><span class="op">[[</span><span class="st">"sca"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/CreateDimReducObject.html" class="external-link">CreateDimReducObject</a></span><span class="op">(</span>embeddings <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">X</span>,
                                                      loadings <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">rotation</span>, 
                                                      stdev <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">eigenvalues</span>,
                                                      assay <span class="op">=</span> <span class="st">"RNA"</span>,key<span class="op">=</span><span class="st">"SC_"</span><span class="op">)</span>
  <span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span><span class="va">sim.data</span>, reduction <span class="op">=</span> <span class="st">"sca"</span>, 
                            k.param <span class="op">=</span> <span class="fl">100</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, 
                            graph.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sca_nn"</span>, <span class="st">"sca_snn"</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
  <span class="va">sim.data</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">FindClusters</a></span><span class="op">(</span><span class="va">sim.data</span>, graph.name <span class="op">=</span> <span class="st">"sca_snn"</span>, resolution <span class="op">=</span> <span class="fl">1</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
  <span class="va">clustering</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">clustering</span>, <span class="va">sim.data</span><span class="op">$</span><span class="va">sca_snn_res.1</span><span class="op">)</span>
  <span class="va">nclust</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nclust</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">sca_snn_res.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">ari</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ari</span>, <span class="fu">mclust</span><span class="fu">::</span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html" class="external-link">adjustedRandIndex</a></span><span class="op">(</span><span class="va">sim.data</span><span class="op">$</span><span class="va">sca_snn_res.1</span>, <span class="va">sim.data</span><span class="op">$</span><span class="va">Spatial.group</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">ari.param</span><span class="op">$</span><span class="va">ari.spatial</span> <span class="op">&lt;-</span> <span class="va">ari</span>
<span class="va">ari.param</span><span class="op">$</span><span class="va">nclust</span> <span class="op">&lt;-</span> <span class="va">nclust</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ARI Spatial"</span>,<span class="st">'#Cluster'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">ari.param</span>, file <span class="op">=</span> <span class="st">"ari.param.bench.rds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">clustering</span>, file <span class="op">=</span> <span class="st">"sca.clustering.rds"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="evaluation">Evaluation<a class="anchor" aria-label="anchor" href="#evaluation"></a>
</h3>
<p>We see that SCA can distinguish the four distinct clusters as long as they are spatially separated. When the locations of the four groups overlapped, the spatial pattern starts to get lost, and only the two groups are revealed, which are distinguished by non-spatial features.</p>
<p>So far we've focused on simulated data. However, for real-world data such as 10x Visium spatial-omics, SCA can identify features that exhibit spatial trends and clusters that are spatially organized. Please see <a href="https://stevexniu.github.io/spots/articles/get_started.html">this tutorial</a> for details.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ari.param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"ari.param.bench.rds"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ari.param</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Var1</span>,<span class="va">Var2</span>,fill <span class="op">=</span> <span class="va">`ARI Spatial`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>,<span class="st">"YlGn"</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.499</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">`ARI Spatial`</span><span class="op">&gt;</span><span class="fl">0.5</span>,<span class="op">]</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Var1</span>,<span class="va">Var2</span><span class="op">)</span>,
            label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">`ARI Spatial`</span><span class="op">&gt;</span><span class="fl">0.5</span>,<span class="st">"ARI Spatial"</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,
            size<span class="op">=</span><span class="fl">6</span>,col<span class="op">=</span><span class="st">"white"</span>, inherit.aes <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">`ARI Spatial`</span><span class="op">&lt;=</span><span class="fl">0.5</span>,<span class="op">]</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Var1</span>,<span class="va">Var2</span><span class="op">)</span>,
            label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">`ARI Spatial`</span><span class="op">&lt;=</span><span class="fl">0.5</span>,<span class="st">"ARI Spatial"</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,
            size<span class="op">=</span><span class="fl">6</span>,col<span class="op">=</span><span class="st">"black"</span>, inherit.aes <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ARI of Spatial Clusters"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html" class="external-link">theme_cowplot</a></span><span class="op">(</span>font_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html" class="external-link">NoAxes</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">30</span>,hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ari.param</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Var1</span>,<span class="va">Var2</span>,fill <span class="op">=</span> <span class="va">`#Cluster`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>,<span class="st">"YlGn"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">`#Cluster`</span><span class="op">&gt;</span><span class="fl">2</span>,<span class="op">]</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Var1</span>,<span class="va">Var2</span><span class="op">)</span>,
            label<span class="op">=</span><span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">`#Cluster`</span><span class="op">&gt;</span><span class="fl">2</span>,<span class="st">"#Cluster"</span><span class="op">]</span>,
            size<span class="op">=</span><span class="fl">6</span>,col<span class="op">=</span><span class="st">"white"</span>, inherit.aes <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">`#Cluster`</span><span class="op">&lt;=</span><span class="fl">2</span>,<span class="op">]</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Var1</span>,<span class="va">Var2</span><span class="op">)</span>,
            label<span class="op">=</span><span class="va">ari.param</span><span class="op">[</span><span class="va">ari.param</span><span class="op">$</span><span class="va">`#Cluster`</span><span class="op">&lt;=</span><span class="fl">2</span>,<span class="st">"#Cluster"</span><span class="op">]</span>,
            size<span class="op">=</span><span class="fl">6</span>,col<span class="op">=</span><span class="st">"black"</span>, inherit.aes <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Number of Clusters"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html" class="external-link">theme_cowplot</a></span><span class="op">(</span>font_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html" class="external-link">NoAxes</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">30</span>,hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="op">)</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></code></pre></div>
<p><img src="SCA_vs_PCA_files/figure-html/evaluation-1.png" width="2880"></p>
</div>
<div class="section level3">
<h3 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h3>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">## R version 4.0.3 (2020-10-10)</span>
<span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">## Running under: macOS Big Sur 10.16</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib</span>
<span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">##  [1] cowplot_1.1.1               RColorBrewer_1.1-2          SeuratObject_4.0.0          Seurat_4.0.1                scater_1.18.3              </span>
<span class="co">##  [6] ggplot2_3.3.3               splatter_1.14.1             SingleCellExperiment_1.12.0 SummarizedExperiment_1.20.0 Biobase_2.50.0             </span>
<span class="co">## [11] GenomicRanges_1.42.0        GenomeInfoDb_1.26.2         IRanges_2.24.1              S4Vectors_0.28.1            BiocGenerics_0.36.0        </span>
<span class="co">## [16] MatrixGenerics_1.2.0        matrixStats_0.57.0          spots_0.1.0                 BiocManager_1.30.10        </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##   [1] backports_1.2.1           systemfonts_0.3.2         plyr_1.8.6                igraph_1.2.6              lazyeval_0.2.2           </span>
<span class="co">##   [6] splines_4.0.3             BiocParallel_1.24.1       listenv_0.8.0             scattermore_0.7           digest_0.6.27            </span>
<span class="co">##  [11] htmltools_0.5.2           viridis_0.5.1             magrittr_2.0.1            checkmate_2.0.0           memoise_2.0.1            </span>
<span class="co">##  [16] tensor_1.5                cluster_2.1.0             ROCR_1.0-11               globals_0.14.0            spatstat.sparse_2.0-0    </span>
<span class="co">##  [21] pkgdown_2.0.2             colorspace_2.0-0          ggrepel_0.9.0             textshaping_0.2.1         xfun_0.30                </span>
<span class="co">##  [26] dplyr_1.0.2               crayon_1.3.4              RCurl_1.98-1.2            jsonlite_1.7.2            spatstat.data_1.7-0      </span>
<span class="co">##  [31] survival_3.2-7            zoo_1.8-8                 glue_1.6.2                polyclip_1.10-0           gtable_0.3.0             </span>
<span class="co">##  [36] zlibbioc_1.36.0           XVector_0.30.0            leiden_0.3.6              DelayedArray_0.16.0       BiocSingular_1.6.0       </span>
<span class="co">##  [41] future.apply_1.7.0        abind_1.4-5               scales_1.1.1              DBI_1.1.0                 miniUI_0.1.1.1           </span>
<span class="co">##  [46] Rcpp_1.0.7                viridisLite_0.3.0         xtable_1.8-4              reticulate_1.18           spatstat.core_1.65-5     </span>
<span class="co">##  [51] rsvd_1.0.3                htmlwidgets_1.5.3         httr_1.4.2                ellipsis_0.3.2            ica_1.0-2                </span>
<span class="co">##  [56] farver_2.0.3              pkgconfig_2.0.3           scuttle_1.0.4             uwot_0.1.10               deldir_0.2-3             </span>
<span class="co">##  [61] sass_0.4.0                locfit_1.5-9.4            labeling_0.4.2            tidyselect_1.1.0          rlang_1.0.2              </span>
<span class="co">##  [66] reshape2_1.4.4            later_1.1.0.1             munsell_0.5.0             tools_4.0.3               cachem_1.0.1             </span>
<span class="co">##  [71] cli_3.2.0                 generics_0.1.0            ggridges_0.5.3            evaluate_0.15             stringr_1.4.0            </span>
<span class="co">##  [76] fastmap_1.1.0             goftest_1.2-2             yaml_2.2.1                ragg_0.4.0                knitr_1.38               </span>
<span class="co">##  [81] fs_1.5.0                  fitdistrplus_1.1-3        purrr_0.3.4               RANN_2.6.1                nlme_3.1-151             </span>
<span class="co">##  [86] pbapply_1.4-3             future_1.21.0             sparseMatrixStats_1.2.0   mime_0.9                  compiler_4.0.3           </span>
<span class="co">##  [91] rstudioapi_0.13           beeswarm_0.2.3            plotly_4.9.2.2            png_0.1-7                 spatstat.utils_2.1-0     </span>
<span class="co">##  [96] tibble_3.0.4              bslib_0.3.1               stringi_1.5.3             highr_0.8                 RSpectra_0.16-0          </span>
<span class="co">## [101] desc_1.4.1                lattice_0.20-41           Matrix_1.3-2              vctrs_0.4.1               pillar_1.4.7             </span>
<span class="co">## [106] lifecycle_1.0.1           spatstat.geom_1.65-5      lmtest_0.9-38             jquerylib_0.1.3           RcppAnnoy_0.0.18         </span>
<span class="co">## [111] BiocNeighbors_1.8.2       data.table_1.13.6         bitops_1.0-6              irlba_2.3.3               httpuv_1.5.4             </span>
<span class="co">## [116] patchwork_1.1.1           R6_2.5.0                  promises_1.1.1            KernSmooth_2.23-18        gridExtra_2.3            </span>
<span class="co">## [121] vipor_0.4.5               parallelly_1.23.0         codetools_0.2-18          MASS_7.3-53               rprojroot_2.0.2          </span>
<span class="co">## [126] withr_2.4.3               sctransform_0.3.2         GenomeInfoDbData_1.2.4    mgcv_1.8-33               rpart_4.1-15             </span>
<span class="co">## [131] grid_4.0.3                beachmat_2.6.4            tidyr_1.1.2               rmarkdown_2.13            DelayedMatrixStats_1.12.1</span>
<span class="co">## [136] Rtsne_0.15                shiny_1.5.0               ggbeeswarm_0.6.0</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by X. Steve Niu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
